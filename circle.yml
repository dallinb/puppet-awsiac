---
machine:
  environment:
    AWS_REGION: eu-west-2
dependencies:
  cache_directories:
    - /home/ubuntu/.bundle
    - /home/ubuntu/.puppetlabs
  override:
    - bundle install
    - rm -rf /home/ubuntu/.puppetlabs/etc/code/modules/awsiac
    - puppet module install --verbose puppetlabs-aws --version 2.0.0
    - puppet module install --verbose puppetlabs-stdlib

compile:
  override:
    - bundle exec rake build
test:
  override:
    - bundle exec rake release_checks
deployment:
  init:
    branch: d1euw1-init
    commands:
      - puppet module install --verbose pkg/locp-awsiac-0.1.0.tar.gz
      - FACTER_ENSURE=present puppet apply --test examples/init.pp
